function doRequest(n,t){var i=$.ajax({url:n.url,method:n.method,data:n.data,dataType:"json"});i.done(function(n){t(!0,n)});i.fail(function(n,i){t(!1,"Request failed: "+i)})}function loadNganh(n,t){doRequest({url:"/api/nganh/"+n,method:"GET",data:{}},t)}function loadHuyen(n,t){doRequest({url:"/api/tinh/"+n+"/huyen",method:"GET",data:{}},t)}function loadXa(n,t,i){doRequest({url:"/api/xa?tid="+n+"&hid="+t,method:"GET",data:{}},i)}function loadTruong(n,t,i){doRequest({url:"/api/truong?tid="+n+"&hid="+t,method:"GET",data:{}},i)}function loadHoSo(n,t){doRequest({url:"/api/hoso?id="+n,method:"GET",data:{}},t)}function loadHoSoCD(n,t){doRequest({url:"/api/hoso/cd?id="+n,method:"GET",data:{}},t)}function fillDDL(n,t){$(n).empty();$(n).append($("<option><\/option>").val("").html("--Chọn--"));$.each(t,function(t,i){$(n).append($("<option><\/option>").val(i.Value).html(i.Text))})}function setTinhHuyenXaTruongControls(n,t,i,r,u,f,e,o){$(n).change(function(){var n=$(this).val();loadHuyen(n,function(n,i){n&&(fillDDL(t,i),f!=undefined&&f!=null&&f!=""&&$(t).val(f))})});i!=undefined&&i!=null&&i!=""&&$(t).change(function(){var t=$(n).val(),r=$(this).val();loadXa(t,r,function(n,t){n&&(fillDDL(i,t),$(i).append($("<option><\/option>").val("00").html("Khác")),e!=undefined&&e!=null&&e!=""?$(i).val(e):t.length<=0&&$(i).val("00"))})});r!=undefined&&r!=null&&r!=""&&$(t).change(function(){var t=$(n).val(),i=$(this).val();loadTruong(t,i,function(n,t){n&&(fillDDL(r,t),o!=undefined&&o!=null&&o!=""&&$(r).val(o))})})}function setTinhHuyenXaTruongValue(n,t,i,r,u,f,e,o){u!=undefined&&u!=null&&u!=""&&$(n).val(u);loadHuyen(u,function(n,s){n&&(fillDDL(t,s),f!=undefined&&f!=null&&f!=""&&$(t).val(f),i!=undefined&&i!=null&&i!=""&&loadXa(u,f,function(n,t){n&&(fillDDL(i,t),$(i).append($("<option><\/option>").val("00").html("Khác")),e!=undefined&&e!=null&&e!=""?$(i).val(e):t.length<=0&&$(i).val("00"))}),r!=undefined&&r!=null&&r!=""&&loadTruong(u,f,function(n,t){n&&(fillDDL(r,t),o!=undefined&&o!=null&&o!=""&&$(r).val(o))}))})}function setNVNganh(){$(".nganhNV").change(function(){var t=$(this).val(),n=$(this).attr("id"),i="#mota"+n;$(i).html("");t!=""?(loadNganh(t,function(n,t){n&&$(i).html(t.Motanganh)}),n=="NV1"?$("#NV2").removeAttr("disabled"):n=="NV2"&&$("#NV3").removeAttr("disabled")):n=="NV1"?($("#NV2, #NV3").val("").attr("disabled","disabled"),$("#motaNV2, #motaNV3").html("")):n=="NV2"&&($("#NV3").val("").attr("disabled","disabled"),$("#motaNV3").html(""))})}function checkFormData(){var n=$("#NV1").val(),t=$("#NV2").val(),i=$("#NV3").val();return n==""&&t==""&&i==""?(alert("Hãy chọn 1 nguyện vọng."),!1):n==t||t==i||n==i?(alert("Các nguyện vọng phải khác nhau."),!1):!0}function copyData(){var n=$("#txtMaHSCu").val();if(n==""){alert("Vui lòng nhập mã hồ sơ cũ");return}loadHoSo(n,function(t,i){if(t)if(i!=null){var r=i.Hoten.split(" "),u=r.slice(0,r.length-1).join(" ");$("#HoLot").val(u);$("#Ten").val(r[r.length-1]);$("#Ngaysinh").val(i.Ngaysinh);$("#Madantoc").val(i.Madantoc);$("#Doituong").val(i.Doituong);$("#Khuvuc").val(i.Khuvuc);$("#Cmnd").val(i.Cmnd);$("#sodienthoai").val(i.sodienthoai);$("#email").val(i.email);setTinhHuyenXaTruongValue("#Matinh","#Mahuyen","#Maxa",null,i.Matinh,i.Mahuyen,i.Maxa,null);$("#Diachi").val(i.Diachi);$("#Ngayvaohk").val(i.Ngayvaohk);setTinhHuyenXaTruongValue("#Matinh10","#Mahuyen10",null,"#Matrpt10",i.Matinh10,i.Mahuyen10,null,i.Matrpt10);setTinhHuyenXaTruongValue("#Matinh11","#Mahuyen11",null,"#Matrpt11",i.Matinh11,i.Mahuyen11,null,i.Matrpt11);setTinhHuyenXaTruongValue("#Matinh12","#Mahuyen12",null,"#Matrpt12",i.Matinh12,i.Mahuyen12,null,i.Matrpt12);$("#NamTN").val(i.NamTN);i.NV1!=undefined&&i.NV1!=null&&i.NV1!=""&&($("#NV1").val(i.NV1).removeAttr("disabled"),loadNganh(i.NV1,function(n,t){n&&$("#motaNV1").html(t.Motanganh)}));i.NV2!=undefined&&i.NV2!=null&&i.NV2!=""&&($("#NV2").val(i.NV2).removeAttr("disabled"),loadNganh(i.NV2,function(n,t){n&&$("#motaNV2").html(t.Motanganh)}));i.NV3!=undefined&&i.NV3!=null&&i.NV3!=""&&($("#NV3").val(i.NV3).removeAttr("disabled"),loadNganh(i.NV3,function(n,t){n&&$("#motaNV3").html(t.Motanganh)}))}else alert("Không thể tìm thấy hồ sơ "+n);else alert(i)})}function setNVNganhCD(){$(".nganhNV").change(function(){var n=$(this).val(),i=$(this).attr("id"),t="#mota"+i;$(t).html("");n!=""&&loadNganh(n,function(n,i){n&&$(t).html(i.Motanganh)})})}function checkFormDataCD(){var r=$("#Toan").val(),u=$("#Ly").val(),t=$("#Hoa").val(),i=$("#NN").val(),n=!0,f;return $("#sp_toan, #sp_ly, #sp_hoa, #sp_nn").empty().hide(),isNaN(r)?($("#sp_toan").html("Điểm toán phải là số").show(),n=!1):isBetween0And10(r)||($("#sp_toan").html("Điểm phải >=0 và <=10").show(),n=!1),isNaN(u)?($("#sp_ly").html("Điểm lý phải là số").show(),n=!1):isBetween0And10(u)||($("#sp_ly").html("Điểm phải >=0 và <=10").show(),n=!1),t.toUpperCase()!="KT"&&isNaN(t)?($("#sp_hoa").html("Điểm lý phải là số hoặc KT").show(),n=!1):isBetween0And10(t)||($("#sp_hoa").html("Điểm phải >=0 và <=10").show(),n=!1),i.toUpperCase()!="KT"&&isNaN(i)?($("#sp_nn").html("Điểm tiếng anh phải là số hoặc KT").show(),n=!1):isBetween0And10(i)||($("#sp_nn").html("Điểm phải >=0 và <=10").show(),n=!1),f=$("#NV1").val(),f==""&&(alert("Hãy chọn 1 nguyện vọng."),n=!1),n}function isBetween0And10(n){if(n.toUpperCase()=="KT")return!0;var t=parseFloat(n);return t>=0&&t<=10?!0:!1}function copyDataCD(){var n=$("#txtMaHSCu").val();if(n==""){alert("Vui lòng nhập mã hồ sơ cũ");return}loadHoSo(n,function(t,i){if(t)if(i!=null){var r=i.Hoten.split(" "),u=r.slice(0,r.length-1).join(" ");$("#HoLot").val(u);$("#Ten").val(r[r.length-1]);$("#Ngaysinh").val(i.Ngaysinh);$("#Madantoc").val(i.Madantoc);$("#Doituong").val(i.Doituong);$("#Khuvuc").val(i.Khuvuc);$("#Cmnd").val(i.Cmnd);$("#sodienthoai").val(i.sodienthoai);$("#email").val(i.email);setTinhHuyenXaTruongValue("#Matinh","#Mahuyen","#Maxa",null,i.Matinh,i.Mahuyen,i.Maxa,null);$("#Diachi").val(i.Diachi);$("#Ngayvaohk").val(i.Ngayvaohk);setTinhHuyenXaTruongValue("#Matinh10","#Mahuyen10",null,"#Matrpt10",i.Matinh10,i.Mahuyen10,null,i.Matrpt10);setTinhHuyenXaTruongValue("#Matinh11","#Mahuyen11",null,"#Matrpt11",i.Matinh11,i.Mahuyen11,null,i.Matrpt11);setTinhHuyenXaTruongValue("#Matinh12","#Mahuyen12",null,"#Matrpt12",i.Matinh12,i.Mahuyen12,null,i.Matrpt12);$("#NamTN").val(i.NamTN);i.NV1!=undefined&&i.NV1!=null&&i.NV1!=""&&($("#NV1").val(i.NV1).removeAttr("disabled"),loadNganh(i.NV1,function(n,t){n&&$("#motaNV1").html(t.Motanganh)}));$("#Sbd").val(i.Sbd);$("#Toan").val(i.Toan);$("#Ly").val(i.Ly);$("#Hoa").val(i.Hoa);$("#NN").val(i.NN)}else alert("Không thể tìm thấy hồ sơ "+n);else alert(i)})}(function(n){var f=0,r={iframe:"iframe",popup:"popup"},u={strict:"strict",loose:"loose",html5:"html5"},e={mode:r.iframe,standard:u.html5,popHt:500,popWd:400,popX:200,popY:200,popTitle:"",popClose:!1,extraCss:"",extraHead:"",retainAttr:["id","class","style"]},t={},i;n.fn.printArea=function(r){var u,s,o;n.extend(t,e,r);f++;u="printArea_";n("[id^="+u+"]").remove();t.id=u+f;s=n(this);o=i.getPrintWindow();i.write(o.doc,s);setTimeout(function(){i.print(o)},1e3)};i={print:function(i){var u=i.win;n(i.doc).ready(function(){u.focus();u.print();t.mode==r.popup&&t.popClose&&setTimeout(function(){u.close()},2e3)})},write:function(n,t){n.open();n.write(i.docType()+"<html>"+i.getHead()+i.getBody(t)+"<\/html>");n.close()},docType:function(){if(t.mode==r.iframe)return"";if(t.standard==u.html5)return"<!DOCTYPE html>";var n=t.standard==u.loose?" Transitional":"",i=t.standard==u.loose?"loose":"strict";return'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01'+n+'//EN" "http://www.w3.org/TR/html4/'+i+'.dtd">'},getHead:function(){var r="",i="";return t.extraHead&&t.extraHead.replace(/([^,]+)/g,function(n){r+=n}),n(document).find("link").filter(function(){var t=n(this).attr("rel");return n.type(t)==="undefined"==!1&&t.toLowerCase()=="stylesheet"}).filter(function(){var t=n(this).attr("media");return n.type(t)==="undefined"||t==""||t.toLowerCase()=="print"||t.toLowerCase()=="all"}).each(function(){i+='<link type="text/css" rel="stylesheet" href="'+n(this).attr("href")+'" >'}),t.extraCss&&t.extraCss.replace(/([^,\s]+)/g,function(n){i+='<link type="text/css" rel="stylesheet" href="'+n+'">'}),"<head><title>"+t.popTitle+"<\/title>"+r+i+"<\/head>"},getBody:function(r){var f="",u=t.retainAttr;return r.each(function(){for(var o=i.getFormData(n(this)),r="",e,t=0;t<u.length;t++)e=n(o).attr(u[t]),e&&(r+=(r.length>0?" ":"")+u[t]+"='"+e+"'");f+="<div "+r+">"+n(o).html()+"<\/div>"}),"<body>"+f+"<\/body>"},getFormData:function(t){var i=t.clone(),r=n("input,select,textarea",i);return n("input,select,textarea",t).each(function(t){var i=n(this).attr("type"),u;n.type(i)==="undefined"&&(i=n(this).is("select")?"select":n(this).is("textarea")?"textarea":"");u=r.eq(t);i=="radio"||i=="checkbox"?u.attr("checked",n(this).is(":checked")):i=="text"?u.attr("value",n(this).val()):i=="select"?n(this).find("option").each(function(t){n(this).is(":selected")&&n("option",u).eq(t).attr("selected",!0)}):i=="textarea"&&u.text(n(this).val())}),i},getPrintWindow:function(){var n,u;switch(t.mode){case r.iframe:return n=new i.Iframe,{win:n.contentWindow||n,doc:n.doc};case r.popup:return u=new i.Popup,{win:u,doc:u.doc}}},Iframe:function(){var r=t.id,i;try{i=document.createElement("iframe");document.body.appendChild(i);n(i).attr({style:"border:0;position:absolute;width:0px;height:0px;right:0px;top:0px;",id:r,src:"#"+(new Date).getTime()});i.doc=null;i.doc=i.contentDocument?i.contentDocument:i.contentWindow?i.contentWindow.document:i.document}catch(u){throw u+". iframes may not be supported in this browser.";}if(i.doc==null)throw"Cannot find document.";return i},Popup:function(){var i="location=yes,statusbar=no,directories=no,menubar=no,titlebar=no,toolbar=no,dependent=no",n;return i+=",width="+t.popWd+",height="+t.popHt,i+=",resizable=yes,screenX="+t.popX+",screenY="+t.popY+",personalbar=no,scrollbars=yes",n=window.open("","_blank",i),n.doc=n.document,n}}})(jQuery)